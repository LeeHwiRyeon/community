<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PWA ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .header p {
            color: #7f8c8d;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .stat-card h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-number.good {
            color: #27ae60;
        }

        .stat-number.warning {
            color: #f39c12;
        }

        .stat-number.error {
            color: #e74c3c;
        }

        .stat-description {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .chart-container h3 {
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .pwa-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .feature-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .feature-card h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .feature-status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .feature-status.supported {
            background: #d5f4e6;
            color: #27ae60;
        }

        .feature-status.not-supported {
            background: #fadbd8;
            color: #e74c3c;
        }

        .feature-status.partial {
            background: #fef9e7;
            color: #f39c12;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-success:hover {
            background: #229954;
        }

        .btn-warning {
            background: #f39c12;
            color: white;
        }

        .btn-warning:hover {
            background: #e67e22;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
        }

        .error {
            background: #e74c3c;
            color: white;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
        }

        .success {
            background: #27ae60;
            color: white;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
        }

        .install-prompt {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }

        .install-prompt h3 {
            margin-bottom: 10px;
        }

        .install-prompt p {
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .install-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .btn-white {
            background: white;
            color: #667eea;
            border: 2px solid white;
        }

        .btn-white:hover {
            background: transparent;
            color: white;
        }

        .btn-outline {
            background: transparent;
            color: white;
            border: 2px solid white;
        }

        .btn-outline:hover {
            background: white;
            color: #667eea;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }

            .pwa-features {
                grid-template-columns: 1fr;
            }

            .controls {
                flex-direction: column;
            }

            .install-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“± PWA ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ</h1>
            <p>Progressive Web Appì˜ ì„±ëŠ¥ê³¼ ì‚¬ìš© í˜„í™©ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•©ë‹ˆë‹¤.</p>
        </div>

        <div class="controls">
            <button class="btn btn-primary" onclick="refreshData()">ìƒˆë¡œê³ ì¹¨</button>
            <button class="btn btn-success" onclick="checkPWAFeatures()">PWA ê¸°ëŠ¥ í™•ì¸</button>
            <button class="btn btn-warning" onclick="testOfflineMode()">ì˜¤í”„ë¼ì¸ í…ŒìŠ¤íŠ¸</button>
        </div>

        <div id="message"></div>

        <!-- PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ -->
        <div id="installPrompt" class="install-prompt" style="display: none;">
            <h3>ğŸš€ PWA ì„¤ì¹˜ ê°€ëŠ¥</h3>
            <p>Community Platformì„ í™ˆ í™”ë©´ì— ì„¤ì¹˜í•˜ì—¬ ë” ë‚˜ì€ ê²½í—˜ì„ ì¦ê¸°ì„¸ìš”!</p>
            <div class="install-buttons">
                <button class="btn btn-white" onclick="installPWA()">ì„¤ì¹˜í•˜ê¸°</button>
                <button class="btn btn-outline" onclick="dismissInstall()">ë‚˜ì¤‘ì—</button>
            </div>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <h3>PWA ì ìˆ˜</h3>
                <div id="pwaScore" class="stat-number">-</div>
                <div class="stat-description">Lighthouse PWA ì ìˆ˜</div>
            </div>
            <div class="stat-card">
                <h3>ì„¤ì¹˜ìœ¨</h3>
                <div id="installRate" class="stat-number">-</div>
                <div class="stat-description">ì‚¬ìš©ì ì„¤ì¹˜ ë¹„ìœ¨</div>
            </div>
            <div class="stat-card">
                <h3>ì˜¤í”„ë¼ì¸ ì‚¬ìš©</h3>
                <div id="offlineUsage" class="stat-number">-</div>
                <div class="stat-description">ì˜¤í”„ë¼ì¸ ì„¸ì…˜ ìˆ˜</div>
            </div>
            <div class="stat-card">
                <h3>ìºì‹œ íˆíŠ¸ìœ¨</h3>
                <div id="cacheHitRate" class="stat-number">-</div>
                <div class="stat-description">ìºì‹œ ì„±ê³µë¥ </div>
            </div>
        </div>

        <div class="chart-container">
            <h3>PWA ì‚¬ìš© í˜„í™©</h3>
            <canvas id="usageChart" width="400" height="200"></canvas>
        </div>

        <div class="chart-container">
            <h3>ì„±ëŠ¥ ì§€í‘œ</h3>
            <canvas id="performanceChart" width="400" height="200"></canvas>
        </div>

        <div class="pwa-features" id="pwaFeatures">
            <div class="loading">PWA ê¸°ëŠ¥ì„ í™•ì¸í•˜ëŠ” ì¤‘...</div>
        </div>
    </div>

    <script>
        let usageChart = null;
        let performanceChart = null;
        let installPrompt = null;

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function () {
            refreshData();
            initializeCharts();
            checkInstallPrompt();
        });

        // ë°ì´í„° ìƒˆë¡œê³ ì¹¨
        async function refreshData() {
            try {
                showMessage('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...', 'info');

                // PWA í†µê³„ ì¡°íšŒ (ì‹¤ì œë¡œëŠ” API í˜¸ì¶œ)
                const pwaStats = await getPWAStats();
                updateDashboard(pwaStats);

                showMessage('ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            } catch (error) {
                console.error('ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì˜¤ë¥˜:', error);
                showMessage('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }

        // PWA í†µê³„ ê°€ì ¸ì˜¤ê¸°
        async function getPWAStats() {
            // ì‹¤ì œë¡œëŠ” APIì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´
            return {
                pwaScore: 95,
                installRate: 23.5,
                offlineUsage: 156,
                cacheHitRate: 87.3,
                features: {
                    serviceWorker: true,
                    manifest: true,
                    https: true,
                    responsive: true,
                    offline: true,
                    pushNotifications: true,
                    backgroundSync: true,
                    webShare: true
                }
            };
        }

        // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
        function updateDashboard(stats) {
            // PWA ì ìˆ˜
            const scoreElement = document.getElementById('pwaScore');
            scoreElement.textContent = stats.pwaScore;
            scoreElement.className = 'stat-number ' + (stats.pwaScore >= 90 ? 'good' :
                stats.pwaScore >= 70 ? 'warning' : 'error');

            // ì„¤ì¹˜ìœ¨
            document.getElementById('installRate').textContent = stats.installRate + '%';

            // ì˜¤í”„ë¼ì¸ ì‚¬ìš©
            document.getElementById('offlineUsage').textContent = stats.offlineUsage;

            // ìºì‹œ íˆíŠ¸ìœ¨
            document.getElementById('cacheHitRate').textContent = stats.cacheHitRate + '%';

            // PWA ê¸°ëŠ¥ í‘œì‹œ
            updatePWAFeatures(stats.features);

            // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            updateCharts(stats);
        }

        // PWA ê¸°ëŠ¥ ì—…ë°ì´íŠ¸
        function updatePWAFeatures(features) {
            const container = document.getElementById('pwaFeatures');

            const featureList = [
                { key: 'serviceWorker', name: 'Service Worker', description: 'ë°±ê·¸ë¼ìš´ë“œ ì‘ì—… ì²˜ë¦¬' },
                { key: 'manifest', name: 'Web App Manifest', description: 'ì•± ì„¤ì¹˜ ë° ë©”íƒ€ë°ì´í„°' },
                { key: 'https', name: 'HTTPS', description: 'ë³´ì•ˆ ì—°ê²°' },
                { key: 'responsive', name: 'ë°˜ì‘í˜• ë””ìì¸', description: 'ëª¨ë“  ë””ë°”ì´ìŠ¤ ì§€ì›' },
                { key: 'offline', name: 'ì˜¤í”„ë¼ì¸ ì§€ì›', description: 'ì¸í„°ë„· ì—†ì´ë„ ì‚¬ìš© ê°€ëŠ¥' },
                { key: 'pushNotifications', name: 'í‘¸ì‹œ ì•Œë¦¼', description: 'ì‹¤ì‹œê°„ ì•Œë¦¼ ì „ì†¡' },
                { key: 'backgroundSync', name: 'ë°±ê·¸ë¼ìš´ë“œ ë™ê¸°í™”', description: 'ì˜¤í”„ë¼ì¸ ë°ì´í„° ë™ê¸°í™”' },
                { key: 'webShare', name: 'ì›¹ ê³µìœ ', description: 'ë„¤ì´í‹°ë¸Œ ê³µìœ  ê¸°ëŠ¥' }
            ];

            const html = featureList.map(feature => {
                const isSupported = features[feature.key];
                const statusClass = isSupported ? 'supported' : 'not-supported';
                const statusText = isSupported ? 'ì§€ì›ë¨' : 'ì§€ì› ì•ˆë¨';

                return `
                    <div class="feature-card">
                        <h4>
                            ${feature.name}
                            <span class="feature-status ${statusClass}">${statusText}</span>
                        </h4>
                        <p>${feature.description}</p>
                    </div>
                `;
            }).join('');

            container.innerHTML = html;
        }

        // ì°¨íŠ¸ ì´ˆê¸°í™”
        function initializeCharts() {
            // ì‚¬ìš© í˜„í™© ì°¨íŠ¸
            const usageCtx = document.getElementById('usageChart').getContext('2d');
            usageChart = new Chart(usageCtx, {
                type: 'line',
                data: {
                    labels: ['1ì¼', '2ì¼', '3ì¼', '4ì¼', '5ì¼', '6ì¼', '7ì¼'],
                    datasets: [{
                        label: 'PWA ì‚¬ìš©ì',
                        data: [120, 135, 142, 138, 156, 148, 162],
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        tension: 0.4
                    }, {
                        label: 'ì›¹ ì‚¬ìš©ì',
                        data: [200, 210, 205, 215, 220, 218, 225],
                        borderColor: '#e74c3c',
                        backgroundColor: 'rgba(231, 76, 60, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // ì„±ëŠ¥ ì§€í‘œ ì°¨íŠ¸
            const performanceCtx = document.getElementById('performanceChart').getContext('2d');
            performanceChart = new Chart(performanceCtx, {
                type: 'doughnut',
                data: {
                    labels: ['ìºì‹œ íˆíŠ¸', 'ë„¤íŠ¸ì›Œí¬ ìš”ì²­', 'ì˜¤í”„ë¼ì¸'],
                    datasets: [{
                        data: [87, 10, 3],
                        backgroundColor: ['#27ae60', '#f39c12', '#e74c3c']
                    }]
                },
                options: {
                    responsive: true
                }
            });
        }

        // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
        function updateCharts(stats) {
            // ì‹¤ì œ ë°ì´í„°ë¡œ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            // ì—¬ê¸°ì„œëŠ” ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„° ì‚¬ìš©
        }

        // PWA ê¸°ëŠ¥ í™•ì¸
        function checkPWAFeatures() {
            const features = {
                serviceWorker: 'serviceWorker' in navigator,
                pushManager: 'PushManager' in window,
                notification: 'Notification' in window,
                backgroundSync: 'serviceWorker' in navigator && 'sync' in window.ServiceWorkerRegistration.prototype,
                webAppManifest: 'onbeforeinstallprompt' in window,
                indexedDB: 'indexedDB' in window,
                webShare: 'share' in navigator,
                webShareTarget: 'serviceWorker' in navigator && 'share' in navigator
            };

            console.log('PWA ê¸°ëŠ¥ ì§€ì› í˜„í™©:', features);
            showMessage('PWA ê¸°ëŠ¥ í™•ì¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì½˜ì†”ì„ í™•ì¸í•˜ì„¸ìš”.', 'success');
        }

        // ì˜¤í”„ë¼ì¸ í…ŒìŠ¤íŠ¸
        function testOfflineMode() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.ready.then(registration => {
                    // ì˜¤í”„ë¼ì¸ ëª¨ë“œ ì‹œë®¬ë ˆì´ì…˜
                    showMessage('ì˜¤í”„ë¼ì¸ ëª¨ë“œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...', 'info');

                    setTimeout(() => {
                        showMessage('ì˜¤í”„ë¼ì¸ ëª¨ë“œ í…ŒìŠ¤íŠ¸ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                    }, 2000);
                });
            } else {
                showMessage('Service Workerë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'error');
            }
        }

        // ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ í™•ì¸
        function checkInstallPrompt() {
            if ('onbeforeinstallprompt' in window) {
                document.getElementById('installPrompt').style.display = 'block';
            }
        }

        // PWA ì„¤ì¹˜
        function installPWA() {
            if (installPrompt) {
                installPrompt.prompt();
                installPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        showMessage('PWAê°€ ì„¤ì¹˜ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                    }
                    installPrompt = null;
                });
            }
        }

        // ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ ë‹«ê¸°
        function dismissInstall() {
            document.getElementById('installPrompt').style.display = 'none';
        }

        // ë©”ì‹œì§€ í‘œì‹œ
        function showMessage(message, type) {
            const messageDiv = document.getElementById('message');
            messageDiv.innerHTML = `<div class="${type}">${message}</div>`;

            setTimeout(() => {
                messageDiv.innerHTML = '';
            }, 5000);
        }

        // ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            installPrompt = e;
            checkInstallPrompt();
        });

        // ì•± ì„¤ì¹˜ ì™„ë£Œ ì´ë²¤íŠ¸
        window.addEventListener('appinstalled', () => {
            showMessage('PWAê°€ ì„±ê³µì ìœ¼ë¡œ ì„¤ì¹˜ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
            document.getElementById('installPrompt').style.display = 'none';
        });

        // ìë™ ìƒˆë¡œê³ ì¹¨ (5ë¶„ë§ˆë‹¤)
        setInterval(refreshData, 5 * 60 * 1000);
    </script>
</body>

</html>