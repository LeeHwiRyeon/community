# 검색 성능/품질 계획 (Phase 1 Step 30)

## 1. 부하 테스트 전략
- 기준 데이터셋: 게시물 100만 건, 태그 1만 개 가정.
- k6 스크립트로 100 RPS 부하를 10분 유지, p95 응답시간 200ms 이하 목표.
- 시나리오: 최신글, 인기글, 태그 검색, 다중 필터 조합 등을 포함.

## 2. 인덱스 튜닝
- 추천 인덱스: `(board_id, created_at DESC)`, `(tag_id, created_at)` 복합 인덱스.
- 부분 인덱스: `deleted = 0` 조건을 포함해 불필요한 스캔 제거.
- 성능 검증: EXPLAIN 분석과 슬로우쿼리 로그 모니터링으로 지속 점검.

## 3. 캐시 전략
- Redis 키: `search:<hash(query+filters)>`, TTL 60초. 인기 검색어는 5분 캐시.
- 무효화 조건: 게시물 생성/수정/삭제, 태그 업데이트 시 해당 키 삭제.
- CDN Edge 캐시: `/api/search` GET 응답을 30초 캐싱(로그인 사용자 제외).

## 4. 모니터링 & SLA
- 핵심 지표: `search.latency.p95`, `search.cache.hit_ratio`, `search.error.rate`.
- Grafana 대시보드로 SLA(95% < 200ms) 준수 여부 확인.
- 품질 지표: NDCG, CTR, 사용자별 재방문율을 주간 리포트로 집계.

## 5. 배포 및 검증 절차
- 인덱스/캐시 변경 시 PM·Infra 팀 동시 승인 필요.
- 롤아웃 체크리스트: DB 마이그레이션, 캐시 플러시 계획, 모니터링 알람 설정 확인.
- 릴리스 노트에 검색 품질 개선 사항과 측정 결과를 첨부.
